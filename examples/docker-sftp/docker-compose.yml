version: "2"

services:

  sftp:
    container_name: sftp
    image: atmoz/sftp
    volumes:
      - ./volume/sftp/share:/home/${SFTP_USER}/share
      - ./volume/sftp/hostkeys/ssh_host_rsa_key:/etc/ssh/ssh_host_rsa_key
      - ./volume/sftp/hostkeys/ssh_host_dsa_key:/etc/ssh/ssh_host_dsa_key
      - ./volume/sftp/hostkeys/ssh_host_ecdsa_key:/etc/ssh/ssh_host_ecdsa_key
      - ./volume/sftp/hostkeys/ssh_host_ed25519_key:/etc/ssh/ssh_host_ed25519_key
      - ./volume/sftp/keyring/id_rsa.pub:/home/${SFTP_USER}/.ssh/keys/id_rsa.pub:ro
    networks:
      stuxnet:
        aliases:
          - sftp
    ports:
        - 22:22
    command: ${SFTP_USER}:${SFTP_PASS}:1001

  client:
    container_name: client
    image: alpine
    volumes:
      - ./volume/client/share:/root/share
      - ./volume/client/keyring:/root/keyring
      - ./volume/client/start.sh:/root/start.sh
    networks:
      stuxnet:
        aliases:
          - client
    depends_on:
      - sftp
    command: /bin/sh /root/start.sh

networks:
  stuxnet:
